<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Absurd Beats Studio</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1><span class="emoji">ğŸ§</span> Absurd Beats Studio</h1>
    <p class="tagline">Where rhythm meets the void.</p>
    <p>Your browser becomes the mixing desk, channeling existential tracks from port 3000 into being.</p>

    <button id="fetch-btn"><span class="emoji">ğŸ¶</span> Resonate with /tracks</button>
    <div id="output">Waiting for data...</div>

    <!-- Add Record Form -->
    <section id="add-record">
      <h2>Add Your Own Track</h2>
      <form id="record-form">
        <label for="title">Title</label>
        <input type="text" id="title" required />

        <label for="bpm">BPM</label>
        <input type="number" id="bpm" required />

        <label for="key">Key</label>
        <input type="text" id="key" required />

        <label for="existential_tag">Existential Tag</label>
        <input type="text" id="existential_tag" required />

        <label for="notes">Notes</label>
        <input type="text" id="notes" />

        <button type="submit">â• Add Track</button>
      </form>
    </section>

    <footer id="quote"></footer>

    <script>
      // API fetch logic with card rendering
      document.getElementById("fetch-btn").addEventListener("click", async () => {
        const output = document.getElementById("output");
        output.textContent = "Fetching data...";
        try {
          const res = await fetch("http://localhost:3000/tracks");
          if (!res.ok) throw new Error("HTTP " + res.status);
          const data = await res.json();

          output.innerHTML = "";

          data.forEach((track, index) => {
            const card = createTrackCard(track);
            card.style.opacity = 0;
            output.appendChild(card);
            setTimeout(() => {
              card.style.transition = "opacity 0.8s ease";
              card.style.opacity = 1;
            }, index * 300);
          });
        } catch (err) {
          output.textContent = "âŒ Could not reach backend (" + err.message + ")";
        }
      });

      // Helper: create a track card
      function createTrackCard(track) {
        const card = document.createElement("div");
        card.className = "track-card";
        card.innerHTML = `
          <div class="track-title">${track.title}</div>
          <div class="track-meta">ğŸµ BPM: ${track.bpm}</div>
          <div class="track-meta">ğŸ¹ Key: ${track.key}</div>
          <div class="track-tag">${track.existential_tag}</div>
          <div class="track-meta">ğŸ“ ${track.notes || ""}</div>
        `;
        return card;
      }

      // Add Record Form logic
      document.getElementById("record-form").addEventListener("submit", (e) => {
        e.preventDefault();

        const track = {
          title: document.getElementById("title").value,
          bpm: document.getElementById("bpm").value,
          key: document.getElementById("key").value,
          existential_tag: document.getElementById("existential_tag").value,
          notes: document.getElementById("notes").value
        };

        const output = document.getElementById("output");
        const card = createTrackCard(track);
        card.style.opacity = 0;
        output.appendChild(card);

        setTimeout(() => {
          card.style.transition = "opacity 0.8s ease";
          card.style.opacity = 1;
        }, 100);

        // Reset form
        e.target.reset();
      });

      // Quotes with type metadata
      const quotes = [
        { text: "â€œMan is condemned to be free.â€ â€” Sartre", type: "philosopher" },
        { text: "â€œThe struggle itself toward the heights is enough to fill a man's heart.â€ â€” Camus", type: "philosopher" },
        { text: "â€œAnxiety is the dizziness of freedom.â€ â€” Kierkegaard", type: "philosopher" },
        { text: "â€œHell is other people.â€ â€” Sartre", type: "philosopher" },
        { text: "â€œOne must imagine Sisyphus happy.â€ â€” Camus", type: "philosopher" },
        { text: "â€œTo live is to suffer, to survive is to find some meaning in the suffering.â€ â€” Nietzsche", type: "philosopher" },
        { text: "â€œMusic is a safe kind of high.â€ â€” Jimi Hendrix", type: "musician" },
        { text: "â€œWithout music, life would be a mistake.â€ â€” Nietzsche", type: "philosopher" },
        { text: "â€œOne good thing about music, when it hits you, you feel no pain.â€ â€” Bob Marley", type: "musician" },
        { text: "â€œIâ€™m just a musical prostitute, my dear.â€ â€” Freddie Mercury", type: "musician" },
        { text: "â€œThe beautiful thing about music is that it transcends language.â€ â€” Herbie Hancock", type: "musician" },
        { text: "â€œMusic can change the world because it can change people.â€ â€” Bono", type: "musician" },
        { text: "â€œLife is what happens while you are busy making other plans.â€ â€” John Lennon", type: "musician" },
        { text: "â€œImagine all the people living life in peace.â€ â€” John Lennon", type: "musician" },
        { text: "â€œI don't know where I'm going from here, but I promise it won't be boring.â€ â€” David Bowie", type: "musician" },
        { text: "â€œWe can be heroes, just for one day.â€ â€” David Bowie", type: "musician" }
      ];

      function setRandomQuote() {
  const footer = document.getElementById("quote");
  const randomIndex = Math.floor(Math.random() * quotes.length);
  const chosen = quotes[randomIndex];
  footer.style.opacity = 0;
  footer.style.animation = "none"; // reset animation
  setTimeout(() => {
    footer.textContent = chosen.text;
    footer.className = chosen.type;
    footer.style.opacity = 1;
    footer.style.animation = "fadeQuote 0.8s ease";
  }, 500);
}

      window.onload = () => {
        setRandomQuote();
        setInterval(setRandomQuote, 10000);
      };
    </script>
  </body>
</html>